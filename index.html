<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Booking Request Demo — EN/ES/FR</title>
  <meta name="description" content="Appointment request demo (EN/ES/FR). Business reviews and confirms by SMS/email." />
  <style>
    :root{
      --bg:#0b0f17;
      --card:#111827;
      --muted:#94a3b8;
      --text:#e5e7eb;
      --line:rgba(148,163,184,.18);
      --accent:#60a5fa;
      --accent2:#34d399;
      --r:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:
        radial-gradient(1200px 800px at 20% -10%, rgba(96,165,250,.22), transparent 60%),
        radial-gradient(1200px 800px at 100% 10%, rgba(52,211,153,.18), transparent 55%),
        var(--bg);
      color:var(--text)
    }
    .wrap{max-width:1040px;margin:0 auto;padding:28px 16px 70px}
    .card{background:rgba(17,24,39,.82);border:1px solid var(--line);border-radius:var(--r);padding:22px;box-shadow:0 14px 60px rgba(0,0,0,.35)}
    .top{display:flex;justify-content:space-between;gap:12px;align-items:center;flex-wrap:wrap}
    .brand b{font-size:16px;letter-spacing:.2px}
    .pill{margin-top:6px;font-size:12px;color:#cfe7ff;opacity:.95}
    .lang{display:flex;gap:8px;flex-wrap:wrap}
    .btn{display:inline-flex;align-items:center;justify-content:center;padding:10px 14px;border-radius:999px;border:1px solid var(--line);background:rgba(11,15,23,.35);color:var(--text);text-decoration:none;font-weight:700;cursor:pointer;user-select:none}
    .btn.primary{background:linear-gradient(135deg,var(--accent),var(--accent2));color:#06101a;border-color:transparent}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    h1{margin:14px 0 10px;font-size:clamp(26px,4vw,40px);line-height:1.12}
    p{margin:0 0 14px;color:var(--muted);line-height:1.55}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:14px}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
    .tile{border:1px solid var(--line);background:rgba(11,15,23,.35);border-radius:14px;padding:14px}
    .tile b{display:block;margin-bottom:6px}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .foot{margin-top:18px;color:var(--muted);font-size:13px;display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .hidden{display:none}
    form{margin-top:14px}
    .formgrid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
    @media(max-width:820px){.formgrid{grid-template-columns:1fr}}
    label{display:block;font-size:13px;color:var(--muted);margin:0 0 6px}
    input, select, textarea{
      width:100%;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(11,15,23,.35);
      color:var(--text);
      outline:none;
    }
    textarea{min-height:96px;resize:vertical}
    .divider{height:1px;background:var(--line);margin:16px 0}
    .status{
      margin-top:12px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(11,15,23,.35);
      color:var(--text);
      display:none;
      line-height:1.4;
      font-size:14px;
    }
    .status.ok{border-color:rgba(52,211,153,.35)}
    .status.err{border-color:rgba(248,113,113,.35)}
    .small{font-size:12px;color:var(--muted);margin-top:10px}
    .consent{
      margin-top:12px;
      border:1px solid var(--line);
      background:rgba(11,15,23,.35);
      border-radius:14px;
      padding:12px 12px;
    }
    .consentRow{display:flex;gap:10px;align-items:flex-start}
    .consent input[type="checkbox"]{width:auto;margin-top:3px}
    .consentText{font-size:12px;color:var(--muted);line-height:1.4}
    .consentText b{color:var(--text)}
    .badge{
      display:inline-flex;align-items:center;gap:8px;
      font-size:12px;color:var(--muted);
      padding:8px 10px;border:1px solid var(--line);border-radius:999px;
      background:rgba(11,15,23,.35);
    }
  </style>
</head>
<body>
  <main class="wrap">
    <div class="card">
      <div class="top">
        <div class="brand">
          <b id="bizNameTop">Booking Demo</b>
          <div class="pill">Requests • Approval • Reminders</div>
        </div>

        <div class="lang">
          <button class="btn" type="button" onclick="setLang('en')">EN</button>
          <button class="btn" type="button" onclick="setLang('es')">ES</button>
          <button class="btn" type="button" onclick="setLang('fr')">FR</button>
        </div>
      </div>

      <!-- EN -->
      <section id="en">
        <h1>Request an appointment in seconds</h1>
        <p>
          Submit your preferred date and time. The business will review availability and confirm.
          You’ll only receive SMS/email for confirmation and reminders — no spam.
        </p>

        <div class="row">
          <span class="badge">Time zone: <b style="color:var(--text)">America/Montreal</b></span>
          <span class="badge">Request ID: <b style="color:var(--text)" id="reqIdEn"></b></span>
        </div>

        <form id="requestFormEn" onsubmit="return submitRequest(event, 'en')">
          <div class="formgrid">
            <div>
              <label for="nameEn">Full name *</label>
              <input id="nameEn" name="name" placeholder="Your name" required />
            </div>
            <div>
              <label for="phoneEn">Phone *</label>
              <input id="phoneEn" name="phone" inputmode="tel" pattern="^[0-9+()\\-\\s]{7,20}$" placeholder="e.g. 5141234567" required />
            </div>

            <div>
              <label for="emailEn">Email *</label>
              <input id="emailEn" name="email" type="email" placeholder="you@gmail.com" required />
            </div>
            <div>
              <label for="serviceEn">Service (optional)</label>
              <select id="serviceEn" name="service">
                <option value="">Select (optional)</option>
                <option>Haircut</option>
                <option>Beard</option>
                <option>Facial</option>
                <option>Nails</option>
                <option>Lashes</option>
                <option>Consultation</option>
                <option>Other</option>
              </select>
            </div>

            <div>
              <label for="dateEn">Preferred date *</label>
              <input id="dateEn" name="date" type="date" required />
            </div>
            <div>
              <label for="timeEn">Preferred time *</label>
              <input id="timeEn" name="time" type="time" required />
            </div>
          </div>

          <div style="margin-top:12px;">
            <label for="noteEn">Notes (optional)</label>
            <textarea id="noteEn" name="note" placeholder="e.g. specific staff, multiple services, special requests..."></textarea>
          </div>

          <div class="consent">
            <div class="consentRow">
              <input id="smsOkEn" name="sms_consent" type="checkbox" required />
              <div class="consentText">
                <b>I agree to receive SMS</b> for <b>appointment confirmation and reminders only</b>. We do not send marketing messages.
              </div>
            </div>
          </div>

          <div class="row">
            <button class="btn primary" id="sendBtnEn" type="submit">Send request</button>
            <button class="btn" type="button" onclick="fillExample('en')">Fill example</button>
          </div>

          <div class="small">This does not auto-confirm your appointment.</div>
          <div class="status" id="statusEn"></div>
        </form>

        <div class="divider"></div>

        <div class="grid">
          <div class="tile"><b>Business approval</b><span>They confirm or propose another time.</span></div>
          <div class="tile"><b>Fewer no-shows</b><span>Reminders by SMS/email (if enabled).</span></div>
          <div class="tile"><b>Everything logged</b><span>Your request is saved for follow-up.</span></div>
        </div>
      </section>

      <!-- ES -->
      <section id="es" class="hidden">
        <h1>Solicita tu cita en segundos</h1>
        <p>
          Envía tu fecha y hora preferidas. El negocio revisa disponibilidad y confirma.
          Solo recibirás SMS/correo para confirmación y recordatorios — sin spam.
        </p>

        <div class="row">
          <span class="badge">Zona horaria: <b style="color:var(--text)">America/Montreal</b></span>
          <span class="badge">ID de solicitud: <b style="color:var(--text)" id="reqIdEs"></b></span>
        </div>

        <form id="requestFormEs" onsubmit="return submitRequest(event, 'es')">
          <div class="formgrid">
            <div>
              <label for="nameEs">Nombre completo *</label>
              <input id="nameEs" name="name" placeholder="Tu nombre" required />
            </div>
            <div>
              <label for="phoneEs">Teléfono *</label>
              <input id="phoneEs" name="phone" inputmode="tel" pattern="^[0-9+()\\-\\s]{7,20}$" placeholder="Ej: 5141234567" required />
            </div>

            <div>
              <label for="emailEs">Email *</label>
              <input id="emailEs" name="email" type="email" placeholder="tunombre@gmail.com" required />
            </div>
            <div>
              <label for="serviceEs">Servicio (opcional)</label>
              <select id="serviceEs" name="service">
                <option value="">Selecciona (opcional)</option>
                <option>Corte</option>
                <option>Barba</option>
                <option>Facial</option>
                <option>Uñas</option>
                <option>Pestañas</option>
                <option>Consulta</option>
                <option>Otro</option>
              </select>
            </div>

            <div>
              <label for="dateEs">Fecha preferida *</label>
              <input id="dateEs" name="date" type="date" required />
            </div>
            <div>
              <label for="timeEs">Hora preferida *</label>
              <input id="timeEs" name="time" type="time" required />
            </div>
          </div>

          <div style="margin-top:12px;">
            <label for="noteEs">Nota (opcional)</label>
            <textarea id="noteEs" name="note" placeholder="Ej: quiero con X persona, varios servicios, etc."></textarea>
          </div>

          <div class="consent">
            <div class="consentRow">
              <input id="smsOkEs" name="sms_consent" type="checkbox" required />
              <div class="consentText">
                <b>Acepto recibir SMS</b> solo para <b>confirmación y recordatorios</b>. No enviamos mensajes de marketing.
              </div>
            </div>
          </div>

          <div class="row">
            <button class="btn primary" id="sendBtnEs" type="submit">Enviar solicitud</button>
            <button class="btn" type="button" onclick="fillExample('es')">Llenar ejemplo</button>
          </div>

          <div class="small">La cita no se confirma automáticamente.</div>
          <div class="status" id="statusEs"></div>
        </form>

        <div class="divider"></div>

        <div class="grid">
          <div class="tile"><b>Control del negocio</b><span>Confirma o propone otro horario.</span></div>
          <div class="tile"><b>Menos “no-shows”</b><span>Recordatorios por SMS/email (si se activan).</span></div>
          <div class="tile"><b>Todo registrado</b><span>La solicitud queda guardada para seguimiento.</span></div>
        </div>
      </section>

      <!-- FR -->
      <section id="fr" class="hidden">
        <h1>Demandez votre rendez-vous en quelques secondes</h1>
        <p>
          Envoyez votre date et heure préférées. L’entreprise vérifie la disponibilité et confirme.
          SMS/email uniquement pour confirmation et rappels — pas de spam.
        </p>

        <div class="row">
          <span class="badge">Fuseau horaire: <b style="color:var(--text)">America/Montreal</b></span>
          <span class="badge">ID demande: <b style="color:var(--text)" id="reqIdFr"></b></span>
        </div>

        <form id="requestFormFr" onsubmit="return submitRequest(event, 'fr')">
          <div class="formgrid">
            <div>
              <label for="nameFr">Nom complet *</label>
              <input id="nameFr" name="name" placeholder="Votre nom" required />
            </div>
            <div>
              <label for="phoneFr">Téléphone *</label>
              <input id="phoneFr" name="phone" inputmode="tel" pattern="^[0-9+()\\-\\s]{7,20}$" placeholder="ex: 5141234567" required />
            </div>

            <div>
              <label for="emailFr">Email *</label>
              <input id="emailFr" name="email" type="email" placeholder="vous@gmail.com" required />
            </div>
            <div>
              <label for="serviceFr">Service (optionnel)</label>
              <select id="serviceFr" name="service">
                <option value="">Choisir (optionnel)</option>
                <option>Coupe</option>
                <option>Barbe</option>
                <option>Soin visage</option>
                <option>Ongles</option>
                <option>Cils</option>
                <option>Consultation</option>
                <option>Autre</option>
              </select>
            </div>

            <div>
              <label for="dateFr">Date préférée *</label>
              <input id="dateFr" name="date" type="date" required />
            </div>
            <div>
              <label for="timeFr">Heure préférée *</label>
              <input id="timeFr" name="time" type="time" required />
            </div>
          </div>

          <div style="margin-top:12px;">
            <label for="noteFr">Note (optionnel)</label>
            <textarea id="noteFr" name="note" placeholder="ex: personnel spécifique, plusieurs services, etc."></textarea>
          </div>

          <div class="consent">
            <div class="consentRow">
              <input id="smsOkFr" name="sms_consent" type="checkbox" required />
              <div class="consentText">
                <b>J’accepte de recevoir des SMS</b> uniquement pour <b>confirmation et rappels</b>. Aucun message marketing.
              </div>
            </div>
          </div>

          <div class="row">
            <button class="btn primary" id="sendBtnFr" type="submit">Envoyer la demande</button>
            <button class="btn" type="button" onclick="fillExample('fr')">Remplir exemple</button>
          </div>

          <div class="small">Ceci ne confirme pas automatiquement le rendez-vous.</div>
          <div class="status" id="statusFr"></div>
        </form>

        <div class="divider"></div>

        <div class="grid">
          <div class="tile"><b>Validation</b><span>L’entreprise confirme ou propose un autre horaire.</span></div>
          <div class="tile"><b>Moins d’absences</b><span>Rappels SMS/email (si activés).</span></div>
          <div class="tile"><b>Historique</b><span>La demande est enregistrée pour suivi.</span></div>
        </div>
      </section>

      <div class="foot">
        <div>© <span id="year"></span> Booking Demo</div>
        <div><a href="mailto:demo@bookingautomation.ca">demo@bookingautomation.ca</a></div>
      </div>
    </div>
  </main>

  <script>
    // CONFIG
    const MAKE_WEBHOOK_URL = "https://hook.us2.make.com/89o2yxre1e38v1pgjjoa7wt9dpmsa12g";
    const TIME_ZONE = "America/Montreal";
    const DEFAULT_LANG = "en"; // English first

    document.getElementById("year").textContent = new Date().getFullYear();

    function setLang(l){
      document.getElementById("en").classList.toggle("hidden", l !== "en");
      document.getElementById("es").classList.toggle("hidden", l !== "es");
      document.getElementById("fr").classList.toggle("hidden", l !== "fr");
      localStorage.setItem("lang", l);
      document.documentElement.lang = l;
      refreshRequestId();
    }

    function newRequestId(){
      const d = new Date();
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,'0');
      const day = String(d.getDate()).padStart(2,'0');
      const rand = Math.random().toString(16).slice(2,10);
      return `req_${y}${m}${day}_${rand}`;
    }

    let currentRequestId = newRequestId();
    function refreshRequestId(){
      currentRequestId = newRequestId();
      document.getElementById("reqIdEn").textContent = currentRequestId;
      document.getElementById("reqIdEs").textContent = currentRequestId;
      document.getElementById("reqIdFr").textContent = currentRequestId;
    }
    refreshRequestId();

    setLang(localStorage.getItem("lang") || DEFAULT_LANG);

    function getForm(lang){
      if(lang === "en") return document.getElementById("requestFormEn");
      if(lang === "es") return document.getElementById("requestFormEs");
      return document.getElementById("requestFormFr");
    }
    function getStatus(lang){
      if(lang === "en") return document.getElementById("statusEn");
      if(lang === "es") return document.getElementById("statusEs");
      return document.getElementById("statusFr");
    }
    function getSendBtn(lang){
      if(lang === "en") return document.getElementById("sendBtnEn");
      if(lang === "es") return document.getElementById("sendBtnEs");
      return document.getElementById("sendBtnFr");
    }

    function fillExample(lang){
      const f = getForm(lang);
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth()+1).padStart(2,'0');
      const dd = String(today.getDate()+1).padStart(2,'0');

      f.querySelector('[name="name"]').value = (lang==="fr") ? "Jean Dupont" : (lang==="es" ? "Juan Pérez" : "John Smith");
      f.querySelector('[name="phone"]').value = "5141234567";
      f.querySelector('[name="email"]').value = "client@example.com";
      f.querySelector('[name="service"]').value = (lang==="fr") ? "Coupe" : (lang==="es" ? "Corte" : "Haircut");
      f.querySelector('[name="date"]').value = `${yyyy}-${mm}-${dd}`;
      f.querySelector('[name="time"]').value = "16:00";
      f.querySelector('[name="note"]').value =
        (lang==="fr") ? "Première visite. Merci de confirmer la disponibilité."
        : (lang==="es") ? "Primera vez. Por favor confirma disponibilidad."
        : "First time. Please confirm availability.";
      f.querySelector('[name="sms_consent"]').checked = true;
    }

    async function submitRequest(event, lang){
      event.preventDefault();

      const form = getForm(lang);
      const status = getStatus(lang);
      const btn = getSendBtn(lang);

      status.className = "status";
      status.style.display = "block";
      status.textContent = (lang==="en") ? "Sending request..." : (lang==="es") ? "Enviando solicitud..." : "Envoi en cours...";

      const data = {
        request_id: currentRequestId,
        lang: lang,
        time_zone: TIME_ZONE,

        name: form.querySelector('[name="name"]').value.trim(),
        phone: form.querySelector('[name="phone"]').value.trim(),
        email: form.querySelector('[name="email"]').value.trim(),
        service: form.querySelector('[name="service"]').value || "",
        date: form.querySelector('[name="date"]').value,
        time: form.querySelector('[name="time"]').value,
        note: form.querySelector('[name="note"]').value.trim(),
        sms_consent: !!form.querySelector('[name="sms_consent"]').checked,

        status: "pending",
        source: "website",
        submitted_at_iso: new Date().toISOString()
      };

      if(!data.name || !data.phone || !data.email || !data.date || !data.time || !data.sms_consent){
        status.className = "status err";
        status.textContent =
          (lang==="en") ? "Please complete required fields and accept SMS consent."
          : (lang==="es") ? "Completa los campos obligatorios y acepta el consentimiento SMS."
          : "Veuillez remplir les champs obligatoires et accepter le consentement SMS.";
        return false;
      }

      btn.disabled = true;

      try{
        const res = await fetch(MAKE_WEBHOOK_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });
        if(!res.ok) throw new Error("HTTP " + res.status);

        status.className = "status ok";
        status.textContent =
          (lang==="en") ? "Request sent! We will confirm by SMS/email."
          : (lang==="es") ? "¡Solicitud enviada! Te confirmaremos por SMS/correo."
          : "Demande envoyée ! Nous confirmerons par SMS/email.";

        form.reset();
        refreshRequestId();
      }catch(err){
        status.className = "status err";
        status.textContent =
          (lang==="en") ? "Error sending request. Please try again."
          : (lang==="es") ? "Error al enviar la solicitud. Intenta de nuevo."
          : "Erreur lors de l’envoi. Réessayez.";
        console.error(err);
      }finally{
        btn.disabled = false;
      }
      return false;
    }
  </script>
</body>
</html>
